
<body>
<div id="tickets">
    <div class="row">
        <div class="col-xs-12">
        <h1 class="text-center">Avaliable Tickets</h1>
            <div class="container">
                <div class="text-center">
                <div class="row">
                <ul id="buttons" class="col-xs-12">
                    <li class="col-xs-3">
                        <div data-name="ralphs" class="store">Ralph's</div>
                    </li>
                    <li class="col-xs-3">
                        <div data-name ="tjs" class="store">TJ's</div>
                    </li>
                    <li class="col-xs-3">
                        <div data-name ="wholeFoods" class="store">WholeFoods</div>
                    </li>
                    <li class="col-xs-3">
                        <div data-name ="vons" class="store">Vons</div>
                    </li>
                </ul>
                </div>
                </div>
            </div>
    <div class="col-xs-12">
    <ul id="tickets_content" class = "text-center">

        <script>

//                    if(selected[$(this).data("name")] === true){
//                        $(this).addClass("show");
//                    }
//                    else{
//                        $(this).addClass("hidden");
//                    }

//
//                        arr = [];
//                        //$("#tickets_content").html("");
//
//                        $('.store.selected').each(function () {
//                            arr.push($(this).data("name"));
//                        });

//                        if(arr.length === 0){
//                            for (var i = 0; i < tickets.length; i++) {
//                                $("#tickets_content").append('<li class = ' + tickets[i].name + '><div id =' +tickets[i].name+ ' >' + tickets[i].name + ' <br> Estimate Deliver Time: ' + tickets[i].time + '</div></li>');
//
//                            }
//                        }
//                        else
//                            for (var j = 0; j < arr.length; j++) {
//                                for (var i = 0; i < tickets.length; i++) {
//                                    if (arr[j] === tickets[i].name) {
//                                        $("#tickets_content").append('<li class = ' + tickets[i].name + '><div id =' + tickets[i].name + ' >' + tickets[i].name + ' <br> Estimate Deliver Time: ' + tickets[i].time + '</div></li>');
//                                    }
//                                }
//                            }
//                        }

//                        for(var i = 0; i < arr.length; i++) {
//                            var name = "." + arr[i];
//                            $(name).each(function(){
//                                $(this).addClass("show");
//                            });
//                        }


//                    })
//                });
//            });

            $('#tickets_content div').click(function () {
                window.location.href = $(this).data("link");
            });

            function _tickets_load() {
                //Actual:
                //loadFromServer();

                //Simulation:
                var simulated_user = {
                    id: 1234567,
                    tickets: [{name: "wholeFoods", time: "12:00 pm"}, {name: "ralphs", time: "5:00 pm"}, {name: "tjs", time: "6:00 pm"},
                        {name: "ralphs", time: "7:00 pm"}, {name: "vons", time: "7:00 pm"}]
                };
                displayLoadedData(simulated_user);

                function loadFromServer() {
                    var request = {
                        "type": "get",
                        "data": null
                    };

                    $.ajax({
                        type: "POST",
                        url: "/_driverList",
                        data: request,
                        success: function (data) {
                            //data is the object sent back on success (could also just be string)
                            displayLoadedData(data);
                        },
                        fail: function (data) {
                            //data is the object send back on fail (could also just be string)
                        }
                    });
                }

                function displayLoadedData(data) {
                    var tickets = [];
                    tickets = data.tickets;

                    function toName(nameString) {
                        var name = {};
                        name['wholeFoods'] = "WholeFoods";
                        name['ralphs'] = "Ralph's";
                        name['tjs'] = "Trader Joe's";
                        name['vons'] = "Vons";

                        return name[nameString];
                    }

                    var selected = {
                        ralphs: true,
                        wholeFoods: true,
                        tjs: true,
                        vons: true
                    };

                    for (var i = 0; i < tickets.length; i++) {
                        $("#tickets_content").append('<li class = ' + tickets[i].name + '><div id =' + tickets[i].name + ' >' + toName(tickets[i].name) + ' <br> Estimate Deliver Time: ' + tickets[i].time + '</div></li>');
                    }

                    $(document).ready(function () {
                        $(".store").each(function () {

                            $(this).click(function () {
                                for (var x in selected) {
                                    selected[x] = false;
                                }

                                $(this).toggleClass("selected");

                                $('.store.selected').each(function () {
                                    selected[$(this).data("name")] = true;
                                })


                                for (var x in selected) {
                                    var a = "." + x;
                                    //console.log(selected[x]);
                                    if (selected[x] == true) {
                                        if ($(a).hasClass("hidden")) {
                                            $(a).removeClass("hidden");
                                        }
                                        $(a).addClass("show");
                                    }
                                    else {
                                        //console.log("hide");
                                        if ($(a).hasClass("show")) {
                                            $(a).removeClass("show");
                                        }
                                        $(a).addClass("hidden");
                                    }
                                }
                            });
                        });

                    });
                }
            }
        _tickets_load();
        </script>
    </ul>
    </div>
            </div>
        </div>
</div>
</body>