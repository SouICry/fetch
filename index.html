<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/css/normalize.css">
    <!--<link rel="stylesheet"-->
    <!--href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/4.0.1/bootstrap-material-design.min.css">css-->
    <link rel="stylesheet" href="/css/style.css">

    <script src="js/loader.js"></script>
</head>
<body style="overflow: hidden; position: relative;">

<div id="User">
    <div class="container">
        <div class="row">
            <div class="col-xs-3"></div>
            <div id="Fetch" class="col-xs-6" style="text-align:center">
                <div id="title">Fetch</div>
            </div>

            <div id="Glyph" class="col-xs-3">
                <div id="open-menu-drawer" class="btn btn-lg pull-right"><span
                        class="glyphicon glyphicon-user large"></span></div>
            </div>
        </div>
    </div>
</div>

<!--Move to grid for laying out everything in same page-->
<div id="page-content" style="overflow-x: visible">
    <div id="abovePages" class=""></div>
    <div id="createTicket" class=""></div>
    <!--<div id="acceptTicket" class=""></div>-->
    <div id="confirmTicket" class=""></div>
    <div id="driverFlow" class=""></div>
</div>

<div id="menu-drawer" class="cd-panel from-right" style="z-index: 3000">


    <div class="cd-panel-container">
        <header id = "panel-Header"class="">
            <h1>hellp</h1>
            <div id="close-menu" class="cd-panel-close">Close</div>
        </header>
        <div class="cd-panel-content">

            <div id="Butt">


                <!--<div id="COG" data-link='/_accSetting.html' class="sign"><span-->
                <!--class="glyphicon glyphicon-cog"></span>Setting-->
                <!--</div>-->
                <!--<div data-link='/_login.html' class="log"><span-->
                <!--class="glyphicon glyphicon-log-in"></span>Login-->
                <!--</div>-->
                <!--<div data-link='/_signUp.html' class="sign"><span-->
                <!--class="glyphicon glyphicon-plus-sign"></span>Sign-Up-->
                <!--</div>-->
                <!--<div data-link='/_passwordRecovery.html' class="sign"><span-->
                <!--class="glyphicon glyphicon-wrench"></span>Password Recovery-->
                <!--</div>-->
                <!--<div data-link='/_passwordReset.html' class="sign"><span-->
                <!--class="glyphicon glyphicon-repeat"></span>Password-->
                <!--Reset-->
                <!--</div>-->
                <!--<div data-link='/_rating.html' class="sign"><span-->
                <!--class="glyphicon glyphicon-signal"></span>Rating-->
                <!--</div>-->
                <!--<div data-link='/_tickets.html' class="sign"><span-->
                <!--class="glyphicon glyphicon-list-alt"></span>Tickets-->
                <!--</div>-->
                <!--<div data-link='/_congrats.html' class="sign">Congrats-->
                <!--</div>-->
                <!--<div data-link='/_checkout.html' class="sign"><span-->
                <!--class="glyphicon glyphicon-check"></span>Checkout-->
                <!--</div>-->
                <!--<div data-link='/_homePage.html' class="log-out"><span-->
                <!--class="glyphicon glyphicon-off"></span>Log-Out-->
                <!--</div>-->


            </div>
        </div> <!-- cd-panel-content -->
    </div> <!-- cd-panel-container -->
</div> <!-- cd-panel -->


<script>

    var currentPage = "_homePage";
    function setFlowVisible(which) {

        $("#page-content").children().each(function () {
            if ($(this).data("ownId") != which) {
                $(this).addClass("hidden");
            }
        });
        $('#' + which).removeClass("hidden");
    }

    function next() {
        var item = $('#' + currentPage);
        var parent = $(item).data('parent');
        var pos = $(item).data('pos');
        if (pos < allPages[parent].length - 1) {
            goToPage(allPages[parent][pos + 1]);
        }
    }

    function previous() {
        var item = $('#' + currentPage);
        var parent = $(item).data('parent');
        var pos = $(item).data('pos');
        if (pos > 0) {
            goToPage(allPages[parent][pos - 1]);
        }
    }

    function goToPreviousPage(){
        goToPage(loader.previousPage);
    }


    function goToPage(id) {
        var item = $('#' + id);
        var parent = $(item).data('parent');
//        setFlowVisible(parent);
        currentPage = id;
        $("#page-content").css('transform',
                'translate(-' + $(item).data("pos") * 100 + '%, -' + $(item).data("vpos") * 100 + '%)')
    }

    window.onhashchange = function () {
        goToPage(window.location.hash.substring(1));
    };

    function loadPage(pageName, element, index, vindex) {
        $.ajax({
            type: "POST",
            url: "/loadPage",
            data: {name: pageName},
            async: false,
            success: function (data) {
                $(element).append("<div id='" + pageName + "' data-ownId='" + pageName + "' " +
                        "data-pos='" + index + "' data-vpos='" + vindex + "' " +
                        "data-parent='" + element.substring(1) + "'>" + data + "</div>");
            }
        });
    }



    var allSections = ['abovePages', 'createTicket', /*'acceptTicket',*/ 'confirmTicket', 'driverFlow'];

    var all=["_accSetting", "_contact", "_history", "_passwordRecovery","_homePage", "_shopping", "_checkout", "_login",
        "_rating","_passwordReset","_signUp","_tickets", "_driverList2", '_congrats',"_yourDeliveries"];

    var allGlyphs = ["glyphicon glyphicon-cog","","","glyphicon glyphicon-wrench","glyphicon glyphicon-home",
        "","glyphicon glyphicon-check","glyphicon glyphicon-log-in","glyphicon glyphicon-signal",
        "glyphicon glyphicon-repeat",
        "glyphicon glyphicon-plus-sign","","", ""];

    var pageNames = ["Setting", "Contact", "History", "Password Recovery","Home", "Shopping", "Checkout", "Login",
        "Rating","Password Reset","Sign Up","Tickets", "Driver List", 'Congrats', "Your Deliveries"];

    var allPages = {
        abovePages: ["_accSetting", "_contact", "_history", "_passwordRecovery" /*,"_passwordReset" ",_signUp", "_login"*/],
        createTicket: ["_homePage", "_shopping", "_checkout", "_login"/*, "_submitted"*/],
        /*acceptTicket: ['_acceptTicket', '_paid'],*/
        confirmTicket: [/*'_confirmTicket',*/ "_rating", /*'_ticketClosed',*/"_passwordReset","_signUp", "_yourDeliveries"],
        driverFlow: ['_tickets', '_driverList', /*'_confirmCompletion', '_completeTicket', '_rating',*/ '_congrats']
    };

    loadPage("_driverTickets", '#driverTickets');
    loadPage("_userTickets", '#userTickets');


    var loader = {
        userId: "",
        previousPage: ""

    };

    $(document).ready(function () {
        $.ajax({
            type: "POST",
            url: "/init",
            data: {},
            success: function(data){
                if (data == null){

                }
                else {
                    loader = data;

                }
            }
        });
        var i;
        var whichid;
        var glyph;
        var name;
        for (var j = 0; j < allSections.length; j++) {
            var sectionName = allSections[j];
            var section = allPages[sectionName];
            for (i = 0; i < section.length; i++) {
                whichid = section[i];
                for(var k=0; k<all.length; k++){
                    if(whichid == all[k]){
                        glyph = allGlyphs[k];
                        name = pageNames[k];
                        break;
                    }
                }
                loadPage(whichid, '#' + sectionName, i, j);
                var clickVal = "onclick=\"goToPage('" + whichid + "');\"";
                $("#Butt").append("<div " + clickVal + " > <span class= '" +glyph+"'></span> "+name+"   </div>");
            }
        }
    });

















    jQuery(document).ready(function ($) {
        //open the lateral panel
        $('#open-menu-drawer').on('click', function (event) {
            $('#menu-drawer').addClass('is-visible');
        });
        //clode the lateral panel
        $('#menu-drawer').on('click', function (event) {
            if ($(event.target).is('.cd-panel') || $(event.target).is('.cd-panel-close')) {
                $('#menu-drawer').removeClass('is-visible');
            }
        });

//        $('#Butt div').click(function () {
//            window.location.href = $(this).data("link");
//        });
//        $('#Fetch div').click(function(){
//            windows.location.href= $(this).data("link");
//        });
    });
</script>


</body>
</html>

